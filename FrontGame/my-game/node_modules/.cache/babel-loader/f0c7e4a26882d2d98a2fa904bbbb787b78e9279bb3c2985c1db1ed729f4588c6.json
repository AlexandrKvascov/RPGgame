{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects\\\\FrontGame\\\\my-game\\\\src\\\\BattlePage.js\",\n  _s = $RefreshSig$();\n// BattlePage.js\nimport { useState, useEffect, useRef } from \"react\";\nimport { setStartBattle } from \"./api.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BattlePage = () => {\n  _s();\n  const state = JSON.parse(localStorage.getItem('status'));\n  console.log(state);\n  const [hp, setHp] = useState(state.player.Player.Health);\n  const [hpEnemy, setHpEnemy] = useState(state.npc.Health);\n  const [battleState, setBattleState] = useState({});\n  const intervalRef = useRef(null);\n  useEffect(() => {\n    const fetchBattleState = async () => {\n      const result = await setStartBattle(state, hp, hpEnemy);\n      setBattleState(result);\n      const number = result.data; // assume the server returns a number\n\n      if (number < 10) {\n        setHp(hp - 15); // enemy attacks, player HP decreases\n      } else {\n        setHpEnemy(hpEnemy - 10); // player attacks, enemy HP decreases\n      }\n\n      // check if the battle is over\n      if (hp <= 0) {\n        sendStatus('lose');\n      } else if (hpEnemy <= 0) {\n        sendStatus('win');\n      }\n    };\n    fetchBattleState(); // initial fetch\n\n    intervalRef.current = setInterval(fetchBattleState, 1000); // fetch every 1 second\n\n    return () => {\n      clearInterval(intervalRef.current);\n    };\n  }, [state, hp, hpEnemy]);\n  const sendStatus = async status => {\n    await setStartBattle(state, hp, hpEnemy, status);\n    console.log(`Battle ended with status: ${status}`);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Battle Page\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Player HP: \", hp]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Enemy HP: \", hpEnemy]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Battle State: \", JSON.stringify(battleState)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n};\n_s(BattlePage, \"8CtVdQrD/iysNGWkhREVVYLANZY=\");\n_c = BattlePage;\nexport default BattlePage;\nvar _c;\n$RefreshReg$(_c, \"BattlePage\");","map":{"version":3,"names":["useState","useEffect","useRef","setStartBattle","jsxDEV","_jsxDEV","BattlePage","_s","state","JSON","parse","localStorage","getItem","console","log","hp","setHp","player","Player","Health","hpEnemy","setHpEnemy","npc","battleState","setBattleState","intervalRef","fetchBattleState","result","number","data","sendStatus","current","setInterval","clearInterval","status","children","fileName","_jsxFileName","lineNumber","columnNumber","stringify","_c","$RefreshReg$"],"sources":["C:/Projects/FrontGame/my-game/src/BattlePage.js"],"sourcesContent":["// BattlePage.js\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { setStartBattle } from \"./api.js\";\r\n\r\nconst BattlePage = () => {\r\n    const state = JSON.parse(localStorage.getItem('status'));\r\n    console.log(state)\r\n  const [hp, setHp] = useState(state.player.Player.Health);\r\n  const [hpEnemy, setHpEnemy] = useState(state.npc.Health);\r\n  const [battleState, setBattleState] = useState({});\r\n  const intervalRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const fetchBattleState = async () => {\r\n      const result = await setStartBattle(state, hp, hpEnemy);\r\n      setBattleState(result);\r\n\r\n      const number = result.data; // assume the server returns a number\r\n\r\n      if (number < 10) {\r\n        setHp(hp - 15); // enemy attacks, player HP decreases\r\n      } else {\r\n        setHpEnemy(hpEnemy - 10); // player attacks, enemy HP decreases\r\n      }\r\n\r\n      // check if the battle is over\r\n      if (hp <= 0) {\r\n        sendStatus('lose');\r\n      } else if (hpEnemy <= 0) {\r\n        sendStatus('win');\r\n      }\r\n    };\r\n\r\n    fetchBattleState(); // initial fetch\r\n\r\n    intervalRef.current = setInterval(fetchBattleState, 1000); // fetch every 1 second\r\n\r\n    return () => {\r\n      clearInterval(intervalRef.current);\r\n    };\r\n  }, [state, hp, hpEnemy]);\r\n\r\n  const sendStatus = async (status) => {\r\n    await setStartBattle(state, hp, hpEnemy, status);\r\n    console.log(`Battle ended with status: ${status}`);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Battle Page</h2>\r\n      <p>Player HP: {hp}</p>\r\n      <p>Enemy HP: {hpEnemy}</p>\r\n      <p>Battle State: {JSON.stringify(battleState)}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BattlePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}