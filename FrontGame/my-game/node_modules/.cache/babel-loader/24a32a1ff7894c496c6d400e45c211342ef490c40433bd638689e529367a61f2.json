{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects\\\\FrontGame\\\\my-game\\\\src\\\\BattlePage.js\",\n  _s = $RefreshSig$();\n// BattlePage.js\nimport { useState, useEffect, useRef } from \"react\";\nimport { setStartBattle } from \"./api.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BattlePage = ({\n  state\n}) => {\n  _s();\n  console.log(state);\n  const [playerHealth, setPlayerHealth] = useState(state.player.Health);\n  const [playerDamage, setPlayerDamage] = useState(state.player.Damage);\n  const [npcHealth, setNpcHealth] = useState(state.npc.Health);\n  const [npcDamage, setNpcDamage] = useState(state.npc.Damage);\n  const [battleState, setBattleState] = useState({});\n  const intervalRef = useRef(null);\n  useEffect(() => {\n    const fetchBattleState = async () => {\n      const result = await setStartBattle(state, playerHealth, npcHealth);\n      setBattleState(result);\n      const number = result.data; // assume the server returns a number\n\n      if (number < 10) {\n        setPlayerHealth(playerHealth - npcDamage); // enemy attacks, player HP decreases\n      } else {\n        setNpcHealth(npcHealth - playerDamage); // player attacks, enemy HP decreases\n      }\n\n      // check if the battle is over\n      if (hp <= 0) {\n        sendStatus('lose');\n      } else if (hpEnemy <= 0) {\n        sendStatus('win');\n      }\n    };\n    fetchBattleState(); // initial fetch\n\n    intervalRef.current = setInterval(fetchBattleState, 1000); // fetch every 1 second\n\n    return () => {\n      clearInterval(intervalRef.current);\n    };\n  }, [state, hp, hpEnemy]);\n  const sendStatus = async status => {\n    await setStartBattle(state, hp, hpEnemy, status);\n    console.log(`Battle ended with status: ${status}`);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Battle Page\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Player HP: \", playerHealth]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Enemy HP: \", npcHealth]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Battle State: \", JSON.stringify(battleState)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n};\n_s(BattlePage, \"xhfM2CUbVGG/7vZWC2Pgx1XbTJA=\");\n_c = BattlePage;\nexport default BattlePage;\nvar _c;\n$RefreshReg$(_c, \"BattlePage\");","map":{"version":3,"names":["useState","useEffect","useRef","setStartBattle","jsxDEV","_jsxDEV","BattlePage","state","_s","console","log","playerHealth","setPlayerHealth","player","Health","playerDamage","setPlayerDamage","Damage","npcHealth","setNpcHealth","npc","npcDamage","setNpcDamage","battleState","setBattleState","intervalRef","fetchBattleState","result","number","data","hp","sendStatus","hpEnemy","current","setInterval","clearInterval","status","children","fileName","_jsxFileName","lineNumber","columnNumber","JSON","stringify","_c","$RefreshReg$"],"sources":["C:/Projects/FrontGame/my-game/src/BattlePage.js"],"sourcesContent":["// BattlePage.js\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { setStartBattle } from \"./api.js\";\r\n\r\nconst BattlePage = ({state}) => {\r\n  console.log(state)\r\n\r\n  const [playerHealth, setPlayerHealth] = useState(state.player.Health);\r\n  const [playerDamage, setPlayerDamage] = useState(state.player.Damage);\r\n  const [npcHealth, setNpcHealth] = useState(state.npc.Health);\r\n  const [npcDamage, setNpcDamage] = useState(state.npc.Damage);\r\n \r\n  const [battleState, setBattleState] = useState({});\r\n  const intervalRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const fetchBattleState = async () => {\r\n      const result = await setStartBattle(state, playerHealth, npcHealth);\r\n      setBattleState(result);\r\n\r\n      const number = result.data; // assume the server returns a number\r\n\r\n      if (number < 10) {\r\n        setPlayerHealth(playerHealth - npcDamage); // enemy attacks, player HP decreases\r\n      } else {\r\n        setNpcHealth(npcHealth - playerDamage); // player attacks, enemy HP decreases\r\n      }\r\n\r\n      // check if the battle is over\r\n      if (hp <= 0) {\r\n        sendStatus('lose');\r\n      } else if (hpEnemy <= 0) {\r\n        sendStatus('win');\r\n      }\r\n    };\r\n\r\n    fetchBattleState(); // initial fetch\r\n\r\n    intervalRef.current = setInterval(fetchBattleState, 1000); // fetch every 1 second\r\n\r\n    return () => {\r\n      clearInterval(intervalRef.current);\r\n    };\r\n  }, [state, hp, hpEnemy]);\r\n\r\n  const sendStatus = async (status) => {\r\n    await setStartBattle(state, hp, hpEnemy, status);\r\n    console.log(`Battle ended with status: ${status}`);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Battle Page</h2>\r\n      <p>Player HP: {playerHealth}</p>\r\n      <p>Enemy HP: {npcHealth}</p>\r\n      <p>Battle State: {JSON.stringify(battleState)}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BattlePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}