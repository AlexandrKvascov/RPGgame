{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects\\\\FrontGame\\\\my-game\\\\src\\\\BattlePage.js\",\n  _s = $RefreshSig$();\n// BattlePage.js\nimport { useState, useEffect, useRef } from \"react\";\nimport { setStartBattle } from \"./api.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BattlePage = () => {\n  _s();\n  const [state, setState] = useState();\n  useEffect(() => {\n    const storedState = localStorage.getItem('status');\n    if (storedState) {\n      setState(JSON.parse(storedState));\n    }\n  }, []);\n  console.log(state);\n  const [hp, setHp] = useState(state.player.Player.Health);\n  const [hpEnemy, setHpEnemy] = useState(state.npc.Health);\n  const [battleState, setBattleState] = useState({});\n  const intervalRef = useRef(null);\n  useEffect(() => {\n    const fetchBattleState = async () => {\n      const result = await setStartBattle(state, hp, hpEnemy);\n      setBattleState(result);\n      const number = result.data; // assume the server returns a number\n\n      if (number < 10) {\n        setHp(hp - 15); // enemy attacks, player HP decreases\n      } else {\n        setHpEnemy(hpEnemy - 10); // player attacks, enemy HP decreases\n      }\n\n      // check if the battle is over\n      if (hp <= 0) {\n        sendStatus('lose');\n      } else if (hpEnemy <= 0) {\n        sendStatus('win');\n      }\n    };\n    fetchBattleState(); // initial fetch\n\n    intervalRef.current = setInterval(fetchBattleState, 1000); // fetch every 1 second\n\n    return () => {\n      clearInterval(intervalRef.current);\n    };\n  }, [state, hp, hpEnemy]);\n  const sendStatus = async status => {\n    await setStartBattle(state, hp, hpEnemy, status);\n    console.log(`Battle ended with status: ${status}`);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Battle Page\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Player HP: \", hp]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Enemy HP: \", hpEnemy]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Battle State: \", JSON.stringify(battleState)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n};\n_s(BattlePage, \"pomaJwt+CoFR8Klmr4HU0hezfJQ=\");\n_c = BattlePage;\nexport default BattlePage;\nvar _c;\n$RefreshReg$(_c, \"BattlePage\");","map":{"version":3,"names":["useState","useEffect","useRef","setStartBattle","jsxDEV","_jsxDEV","BattlePage","_s","state","setState","storedState","localStorage","getItem","JSON","parse","console","log","hp","setHp","player","Player","Health","hpEnemy","setHpEnemy","npc","battleState","setBattleState","intervalRef","fetchBattleState","result","number","data","sendStatus","current","setInterval","clearInterval","status","children","fileName","_jsxFileName","lineNumber","columnNumber","stringify","_c","$RefreshReg$"],"sources":["C:/Projects/FrontGame/my-game/src/BattlePage.js"],"sourcesContent":["// BattlePage.js\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { setStartBattle } from \"./api.js\";\r\n\r\nconst BattlePage = () => {\r\n    const [state, setState] = useState()\r\n    useEffect(() => {\r\n        const storedState = localStorage.getItem('status');\r\n        if (storedState) {\r\n          setState(JSON.parse(storedState));\r\n        }\r\n      }, []);\r\n    \r\n      console.log(state);\r\n  const [hp, setHp] = useState(state.player.Player.Health);\r\n  const [hpEnemy, setHpEnemy] = useState(state.npc.Health);\r\n  const [battleState, setBattleState] = useState({});\r\n  const intervalRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const fetchBattleState = async () => {\r\n      const result = await setStartBattle(state, hp, hpEnemy);\r\n      setBattleState(result);\r\n\r\n      const number = result.data; // assume the server returns a number\r\n\r\n      if (number < 10) {\r\n        setHp(hp - 15); // enemy attacks, player HP decreases\r\n      } else {\r\n        setHpEnemy(hpEnemy - 10); // player attacks, enemy HP decreases\r\n      }\r\n\r\n      // check if the battle is over\r\n      if (hp <= 0) {\r\n        sendStatus('lose');\r\n      } else if (hpEnemy <= 0) {\r\n        sendStatus('win');\r\n      }\r\n    };\r\n\r\n    fetchBattleState(); // initial fetch\r\n\r\n    intervalRef.current = setInterval(fetchBattleState, 1000); // fetch every 1 second\r\n\r\n    return () => {\r\n      clearInterval(intervalRef.current);\r\n    };\r\n  }, [state, hp, hpEnemy]);\r\n\r\n  const sendStatus = async (status) => {\r\n    await setStartBattle(state, hp, hpEnemy, status);\r\n    console.log(`Battle ended with status: ${status}`);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Battle Page</h2>\r\n      <p>Player HP: {hp}</p>\r\n      <p>Enemy HP: {hpEnemy}</p>\r\n      <p>Battle State: {JSON.stringify(battleState)}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BattlePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}